{% load static %}
<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>
        {%  block  title %}
            Book store
        {% endblock %}
    </title>

    <link rel="stylesheet" href="{% static 'css/general.css' %}">
    <link rel="stylesheet" href="{% static "css/cookies.css" %}">
    {% block links %}
{#        additional stylesheets here #}
    {% endblock %}

</head>
<body>
    {% block header %}
        <header id="topnav">
            <div id="logo">
                <a href="{% url "index" %}">
                    <img src="{% static "img/bookman.png" %}" alt="bookman logo" id="logo-img">
                </a>
            </div>

            <nav>
                <a href="/about">About</a>
                <a href="/faq">FAQ</a>
                {% if user.is_authenticated %}
                    Welcome, <i>{{ user.username }}</i> | <a href="{% url 'logout' %}">Logout</a>
                    <br>
                    <a href="/profile">Profile</a>
                {% else %}
                    <a href="{% url 'login' %}">Login</a> | <a href="{% url 'register' %}">Register</a>
                {% endif %}
                <a href="/browse">Browse</a>
            </nav>

            <button class="hamburger" id="hamburger-button">
                <img src="{% static "img/cart.png" %}" alt="cart icon">
                <span class="quantity">{{ total_quantity }}</span>
            </button>

            <div id="sidebar" class="sidebar">
                <a class="cart-link" href="/cart">Cart</a>
                <ul>
                    {% if cart_books_in_cart %}
                        {% for item in cart_books_in_cart %}
                            <li>
                                <div class="fst-pair">
                                    <div class="div1">
                                        <img src="../static/img/{{ item.book.img }}" alt="{{ item.book.title }}">
                                    </div>
                                    <div class="div4">
                                        <button onclick="updateQuantity('{{ item.book.id }}', 1)">+</button>
                                        <div class="count">{{ item.quantity }}</div>

                                        <button onclick="updateQuantity('{{ item.book.id }}', -1)">-</button>
                                    </div>
                                </div>
                                <div class="secnd-pair">
                                    <div class="div2">
                                        <p>{{ item.book.title }}</p>
                                    </div>

                                    <div class="div3">
                                        price: ${{ item.total_price }}, {{ item.quantity }} x {{ item.book.price }}
                                    </div>
                                </div>

                            </li>
                        {% endfor %}
                    {% else %}
                        <h1>No items in cart</h1>
                    {% endif %}
                </ul>
                <div class="checkout">
                    <div class="total">Total: ${{ cart_final_price }}</div>
                    <div id="close-btn">Close</div>
                </div>
            </div>
            <div class="messages">
            {% if messages %}
                {% for message in messages %}
                    <div class="{{ message.tags }}">
                        <b>{{ message }}</b>
                    </div>
                {% endfor %}
            {% endif %}
            </div>
        </header>
    {% endblock %}
    
    <div id="content-wrapper">
            {% block main %}
                
            {% endblock %}
            
        
            <section id="chatbot">
                <button id="chatbotTrigger" class="chatbot-trigger">Chat with us!</button>
                
                <div id="chatbotContainer" class="chatbot-container">
                    <div class="chatbot-header">
                        <h2>Chatbot</h2>
                        <button id="closeChatbot" class="chatbot-close">&times;</button>
                    </div>
                    <div class="chatbot-content">
                        <!-- Area where chat messages will be displayed -->

                        <!-- Added demonstration button here -->
                        <button id="demoButton" class="demo-button" onclick="hideDemo()">Recommend a book on stoicism</button>
                    </div>
                    
                    <div class="chatbot-input-area">
                        <input type="text" id="chatInput" class="chat-input" placeholder="Type your message...">
                        <button id="sendMessage" class="send-message">Send</button>
                    </div>
                </div>
            </section>



    
    
    
    </div>
    {% block footer %}
        
        <div id="cookieConsentModal" class="cookie-consent-modal">
            <div class="cookie-content">
                <p>Why we use cookies and other tracking technologies?
                    Our site enables script (e.g. cookies) that is able to read, store, and write information on your browser and in your device. 
                    The information processed by this script includes data relating to you which may include personal identifiers (e.g. IP address and session details) 
                    and browsing activity. We use this information for various purposes - e.g. to deliver content, maintain security, enable user choice, improve our sites, 
                    and for marketing purposes. You can reject all non-essential processing by choosing to accept only necessary cookies.
                    <a href="">Cookie Notice</a></p>
                <button id="acceptCookieBtn" class="cookie-btn">Accept</button>
                <button id="rejectCookieBtn" class="cookie-btn">Accept only essential</button>
            </div>
        </div>

    <footer id="site-footer">
        {% now 'Y' as current_year %}
        Shop App CC0 2023 - {{ current_year }}
    </footer>
    {% endblock %}

</body>
<script src="{% static "js/sidebar.js" %}"></script>
<script src="{% static "js/update_quantity.js" %}"></script>
<script src="{% static "js/cookies.js" %}"></script>
<script src="{% static "js/chatbot.js" %}"></script>

<script>
function hideDemo() {
    const demoButton = document.getElementById('demoButton');
    demoButton.offsetHeight;
    demoButton.classList.add('demo-button-clicked'); // This triggers the fade-out transition
}

</script>

{% block javascript %}

{% endblock %}


</html>